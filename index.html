<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>حاسبة الشاي</title>
  <style>
    :root { font-family: system-ui, -apple-system, "Segoe UI", Tahoma, Arial; }
    body { margin: 0; background:#0b1220; color:#e9eefc; }
    .wrap { max-width: 880px; margin: 0 auto; padding: 24px; }
    .card {
      background: rgba(255,255,255,0.06);
      border: 1px solid rgba(255,255,255,0.10);
      border-radius: 16px;
      padding: 18px;
      backdrop-filter: blur(8px);
    }
    h1 { margin: 0 0 8px; font-size: 22px; }
    p.sub { margin: 0 0 18px; opacity: .85; }
    .grid { display: grid; gap: 12px; grid-template-columns: 1fr; }
    @media (min-width: 780px){ .grid { grid-template-columns: 1fr 1fr; } }
    label { font-size: 13px; opacity: .9; display:block; margin-bottom: 6px; }
    select, input {
      width: 100%;
      padding: 12px 12px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.16);
      background: rgba(0,0,0,0.25);
      color: #e9eefc;
      outline: none;
      font-size: 15px;
    }
    .row { display:flex; gap:10px; align-items:center; }
    .row > * { flex:1; }
    .btns { display:flex; gap:10px; margin-top: 12px; flex-wrap: wrap; }
    button {
      padding: 12px 14px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.16);
      background: rgba(255,255,255,0.10);
      color:#e9eefc;
      cursor:pointer;
      font-size: 14px;
    }
    button:hover { background: rgba(255,255,255,0.16); }
    .out {
      margin-top: 14px;
      background: rgba(0,0,0,0.22);
      border: 1px solid rgba(255,255,255,0.10);
      border-radius: 14px;
      padding: 14px;
      line-height: 1.8;
    }
    .kpi { display:grid; gap:10px; grid-template-columns: 1fr; }
    @media (min-width: 780px){ .kpi { grid-template-columns: 1fr 1fr 1fr; } }
    .box { padding: 12px; border-radius: 14px; background: rgba(255,255,255,0.06); border: 1px solid rgba(255,255,255,0.10);}
    .muted { opacity: .85; font-size: 13px; }
    .big { font-size: 18px; font-weight: 700; margin-top: 6px; }
    .note { margin-top: 10px; font-size: 12px; opacity:.78; }
    .footer { margin-top: 14px; font-size: 12px; opacity:.75; }
    a { color:#a9c7ff; }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="card">
      <h1>حاسبة الشاي ☕</h1>
      <p class="sub">اختر نوع الشاي/البراند، وحط كمية الماء… ويطلع لك الوزن + السكر + مدة الخدرة.</p>

      <div class="grid">
        <div>
          <label>اختر المنتج</label>
          <select id="teaSelect"></select>
        </div>

        <div>
          <label>كمية الماء</label>
          <div class="row">
            <input id="waterValue" type="number" inputmode="decimal" min="1" value="1000" />
            <select id="waterUnit">
              <option value="ml">مل</option>
              <option value="l">لتر</option>
            </select>
          </div>
          <div class="muted" style="margin-top:6px">مثال: 500 مل أو 1 لتر</div>
        </div>

        <div>
          <label>السكر</label>
          <select id="sugarMode">
            <option value="range">حسب مدى السكر المسجل</option>
            <option value="none">بدون سكر</option>
          </select>
          <div class="muted" style="margin-top:6px">حالياً: يا “حسب المدى” أو “بدون”. نقدر نضيف خفيف/وسط/ثقيل بعدين.</div>
        </div>

        <div>
          <label>تقريب الأرقام</label>
          <select id="roundMode">
            <option value="1">تقريب لرقم عشري (مثل 6.5)</option>
            <option value="0">تقريب لعدد صحيح (مثل 7)</option>
            <option value="2">رقمين عشريين (مثل 6.50)</option>
          </select>
        </div>
      </div>

      <div class="btns">
        <button id="calcBtn">احسب</button>
        <button id="resetBtn">تصفير</button>
      </div>

      <div class="out" id="output" aria-live="polite"></div>

      <div class="footer">
        تبي تضيف منتجات زيادة؟ فقط زوّدني بنفس تنسيق بياناتك، أو عدّل ملف البيانات داخل الكود (قسم <b>DATA</b>).
      </div>
    </div>
  </div>

<script>
/** =========================
 *  DATA (منتجاتك)
 *  كل القيم "لكل 1 لتر"
 *  تقدر تضيف عناصر زيادة بنفس الشكل
 * ========================= */
const TEAS = [
  {
    id: "nahrain-op",
    teaType: "OP",
    brand: "شاي النهرين",
    gramsPerLiter: { min: 12, max: 12 },
    sugarPerLiter: { min: 50, max: 55 },
    steepMinutes:  { min: 20, max: 25 }
  },
  {
    id: "naif-op1",
    teaType: "OP1",
    brand: "شاي نايف",
    gramsPerLiter: { min: 14, max: 14 },
    sugarPerLiter: { min: 50, max: 55 },
    steepMinutes:  { min: 30, max: 35 }
  }
];

/** ===== Helpers ===== */
const fmt = (num, decimals) => {
  const f = Number(num);
  if (!Number.isFinite(f)) return "-";
  return f.toFixed(decimals);
};

const clamp = (v, min, max) => Math.min(Math.max(v, min), max);

function toLiters(value, unit){
  const v = Number(value);
  if (!Number.isFinite(v) || v <= 0) return NaN;
  return unit === "l" ? v : (v / 1000);
}

function rangeMultiply(range, liters){
  return { min: range.min * liters, max: range.max * liters };
}

function rangeText(r, decimals){
  // إذا نفس القيمة، نطلع رقم واحد
  if (Math.abs(r.min - r.max) < 1e-9) return fmt(r.min, decimals);
  return `${fmt(r.min, decimals)} – ${fmt(r.max, decimals)}`;
}

function minutesText(r){
  if (r.min === r.max) return `${r.min} دقيقة`;
  return `${r.min} – ${r.max} دقيقة`;
}

/** ===== UI ===== */
const teaSelect = document.getElementById("teaSelect");
const waterValue = document.getElementById("waterValue");
const waterUnit  = document.getElementById("waterUnit");
const sugarMode  = document.getElementById("sugarMode");
const roundMode  = document.getElementById("roundMode");
const output     = document.getElementById("output");

function populateSelect(){
  teaSelect.innerHTML = "";
  TEAS.forEach(t => {
    const opt = document.createElement("option");
    opt.value = t.id;
    opt.textContent = `${t.teaType} — ${t.brand}`;
    teaSelect.appendChild(opt);
  });
}

function getSelectedTea(){
  const id = teaSelect.value;
  return TEAS.find(t => t.id === id) || TEAS[0];
}

function render(){
  const tea = getSelectedTea();
  const liters = toLiters(waterValue.value, waterUnit.value);
  const decimals = Number(roundMode.value);

  if (!Number.isFinite(liters)) {
    output.innerHTML = `⚠️ دخل كمية ماء صحيحة.`;
    return;
  }

  const teaRange   = rangeMultiply(tea.gramsPerLiter, liters);
  const sugarRange = rangeMultiply(tea.sugarPerLiter, liters);

  const teaGramsText = rangeText(teaRange, decimals);
  const sugarText = sugarMode.value === "none"
    ? "بدون"
    : rangeText(sugarRange, decimals);

  output.innerHTML = `
    <div class="kpi">
      <div class="box">
        <div class="muted">وزن الشاي المطلوب</div>
        <div class="big">${teaGramsText} جم</div>
      </div>
      <div class="box">
        <div class="muted">السكر</div>
        <div class="big">${sugarText}${sugarMode.value === "none" ? "" : " جم"}</div>
      </div>
      <div class="box">
        <div class="muted">مدة الخدرة</div>
        <div class="big">${minutesText(tea.steepMinutes)}</div>
      </div>
    </div>

    <div class="note">
      <b>المنتج:</b> ${tea.teaType} — ${tea.brand}<br/>
      <b>الماء:</b> ${waterValue.value} ${waterUnit.value === "l" ? "لتر" : "مل"} (${fmt(liters, 3)} لتر)
    </div>
  `;
}

document.getElementById("calcBtn").addEventListener("click", render);
document.getElementById("resetBtn").addEventListener("click", () => {
  teaSelect.selectedIndex = 0;
  waterValue.value = 1000;
  waterUnit.value = "ml";
  sugarMode.value = "range";
  roundMode.value = "1";
  render();
});

// تحديث تلقائي عند التغيير
[teaSelect, waterValue, waterUnit, sugarMode, roundMode].forEach(el => {
  el.addEventListener("input", render);
  el.addEventListener("change", render);
});

populateSelect();
render();
</script>
</body>
</html>
