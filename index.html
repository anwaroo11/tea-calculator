<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>حاسبة الشاي</title>
  <style>
    :root { font-family: system-ui, -apple-system, "Segoe UI", Tahoma, Arial; }
    body { margin: 0; background:#0b1220; color:#e9eefc; }
    .wrap { max-width: 980px; margin: 0 auto; padding: 24px; }
    .card {
      background: rgba(255,255,255,0.06);
      border: 1px solid rgba(255,255,255,0.10);
      border-radius: 16px;
      padding: 18px;
      backdrop-filter: blur(8px);
    }
    h1 { margin: 0 0 8px; font-size: 22px; }
    p.sub { margin: 0 0 18px; opacity: .85; }

    .grid { display: grid; gap: 12px; grid-template-columns: 1fr; }
    @media (min-width: 780px){ .grid { grid-template-columns: 1fr 1fr; } }

    label { font-size: 13px; opacity: .9; display:block; margin-bottom: 6px; }
    select, input {
      width: 100%;
      padding: 12px 12px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.16);
      background: rgba(0,0,0,0.25);
      color: #e9eefc;
      outline: none;
      font-size: 15px;
      box-sizing: border-box;
      height: 48px;
    }
    input[type=number] { appearance: textfield; -moz-appearance: textfield; }
    input[type=number]::-webkit-outer-spin-button,
    input[type=number]::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }

    .out {
      margin-top: 14px;
      background: rgba(0,0,0,0.22);
      border: 1px solid rgba(255,255,255,0.10);
      border-radius: 14px;
      padding: 14px;
      line-height: 1.8;
    }

    .kpi { display:grid; gap:10px; grid-template-columns: 1fr; }
    @media (min-width: 780px){ .kpi { grid-template-columns: 1fr 1fr; } }
    @media (min-width: 1024px){ .kpi { grid-template-columns: 1fr 1fr 1fr 1fr; } }

    .box {
      padding: 12px;
      border-radius: 14px;
      background: rgba(255,255,255,0.06);
      border: 1px solid rgba(255,255,255,0.10);
    }
    .muted { opacity: .75; font-size: 12px; margin-top: 4px; }
    .muted2 { opacity: .75; font-size: 12px; margin-top: 6px; }
    .big { font-size: 18px; font-weight: 700; margin-top: 6px; }
    .note { margin-top: 10px; font-size: 12px; opacity:.80; }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="card">
      <h1>حاسبة الشاي ☕</h1>
      <p class="sub">اختر الشاي، وحط كمية الماء بالمل… وتطلع لك وزنية الشاي + السكر حسب المذاق + مدة الخدرة + كم بيالة تكفي.</p>

      <div class="grid">
        <div>
          <label>اختر الشاي</label>
          <select id="teaSelect"></select>
        </div>

        <div>
          <label>كمية الماء (مل)</label>
          <input id="waterMl" type="number" inputmode="decimal" min="1" value="1000" />
          <div class="muted">مثال: 500 أو 750 أو 1000</div>
        </div>

        <div>
          <label>المذاق</label>
          <select id="taste">
            <option value="normal" selected>مناسب</option>
            <option value="heavy">ثقيل</option>
            <option value="nosugar">بدون سكر</option>
          </select>
          <div class="muted" id="tasteHint"></div>
        </div>
      </div>

      <div class="out" id="output" aria-live="polite"></div>
    </div>
  </div>

<script>
/** =========================
 *  DATA (عدّل هنا)
 *  كل القيم "لكل 1 لتر"
 *  teaPerLiter: مدى جرام الشاي (min/max)
 *  sugarPerLiter: مدى السكر (min/max)
 *  steepMinutes: مدى مدة الخدرة
 *
 *  المذاق:
 *   - مناسب => الأقل (min)
 *   - ثقيل => الأعلى (max)
 *   - بدون سكر => شاي min + سكر 0
 * ========================= */
const TEAS = [
  {
    id: "nahrain-op",
    teaType: "OP",
    brand: "شاي النهرين",
    teaPerLiter:   { min: 12, max: 12 },     // إذا تبي الشاي يتغير مع المذاق: خلها مثل {min: 11, max: 13}
    sugarPerLiter: { min: 50, max: 55 },
    steepMinutes:  { min: 20, max: 25 }
  },
  {
    id: "naif-op1",
    teaType: "OP1",
    brand: "شاي نايف",
    teaPerLiter:   { min: 14, max: 14 },
    sugarPerLiter: { min: 50, max: 55 },
    steepMinutes:  { min: 30, max: 35 }
  }
];

// افتراض البيالة
const CUP_ML = 100;

/** ===== Helpers ===== */
function smartNumber(n){
  if (!Number.isFinite(n)) return "-";
  const isInt = Math.abs(n - Math.round(n)) < 1e-9;
  return isInt ? String(Math.round(n)) : n.toFixed(1);
}
function toLitersFromMl(ml){
  const v = Number(ml);
  if (!Number.isFinite(v) || v <= 0) return NaN;
  return v / 1000;
}
function minutesText(r){
  if (r.min === r.max) return `${r.min} دقيقة`;
  return `${r.min} – ${r.max} دقيقة`;
}
function pickByTaste(range, taste){
  if (taste === "heavy") return range.max;
  return range.min; // مناسب + بدون سكر => الأقل
}

/** ===== UI ===== */
const teaSelect  = document.getElementById("teaSelect");
const waterMlInp = document.getElementById("waterMl");
const tasteSel   = document.getElementById("taste");
const tasteHint  = document.getElementById("tasteHint");
const output     = document.getElementById("output");

function populateTeaSelect(){
  teaSelect.innerHTML = "";
  TEAS.forEach(t => {
    const opt = document.createElement("option");
    opt.value = t.id;
    opt.textContent = `${t.brand} — ${t.teaType}`;
    teaSelect.appendChild(opt);
  });
}

function getSelectedTea(){
  const id = teaSelect.value;
  return TEAS.find(t => t.id === id) || TEAS[0];
}

function tasteLabel(v){
  if (v === "heavy") return "ثقيل";
  if (v === "nosugar") return "بدون سكر";
  return "مناسب";
}

function render(){
  const tea = getSelectedTea();
  const liters = toLitersFromMl(waterMlInp.value);

  if (!Number.isFinite(liters)) {
    output.innerHTML = `⚠️ دخل كمية ماء صحيحة بالمل.`;
    return;
  }

  const taste = tasteSel.value;

  // الشاي حسب المذاق
  const teaPerLiterPicked = pickByTaste(tea.teaPerLiter, taste);
  const teaGrams = teaPerLiterPicked * liters;

  // السكر حسب المذاق
  let sugarText = "بدون";
  if (taste !== "nosugar") {
    const sugarPerLiterPicked = pickByTaste(tea.sugarPerLiter, taste);
    const sugarGrams = sugarPerLiterPicked * liters;
    sugarText = `${smartNumber(sugarGrams)} جم`;
  }

  // تلميح يوضح أوزان هذا الشاي (لكل لتر)
  tasteHint.textContent =
    `لكل 1 لتر: مناسب (شاي ${smartNumber(tea.teaPerLiter.min)} جم • سكر ${smartNumber(tea.sugarPerLiter.min)} جم) — ثقيل (شاي ${smartNumber(tea.teaPerLiter.max)} جم • سكر ${smartNumber(tea.sugarPerLiter.max)} جم)`;

  // البيالات (تقريباً) على افتراض 100 مل
  const waterMl = Number(waterMlInp.value);
  const cups = (Number.isFinite(waterMl) && waterMl > 0) ? (waterMl / CUP_ML) : NaN;
  const cupsText = smartNumber(cups);

  output.innerHTML = `
    <div class="kpi">
      <div class="box">
        <div class="muted">وزن الشاي المطلوب</div>
        <div class="big">${smartNumber(teaGrams)} جم</div>
        <div class="muted2">${tasteLabel(taste)} • لكل لتر: ${smartNumber(teaPerLiterPicked)} جم</div>
      </div>

      <div class="box">
        <div class="muted">السكر</div>
        <div class="big">${sugarText}</div>
        <div class="muted2">${taste === "nosugar" ? "بدون سكر" : `لكل لتر: ${smartNumber(pickByTaste(tea.sugarPerLiter, taste))} جم`}</div>
      </div>

      <div class="box">
        <div class="muted">مدة الخدرة</div>
        <div class="big">${minutesText(tea.steepMinutes)}</div>
      </div>

      <div class="box">
        <div class="muted">كم بيالة تكفي (تقريباً)</div>
        <div class="big">${cupsText}</div>
        <div class="muted2">حجم البيالة الواحدة تقريبًا ١٠٠ مل</div>
      </div>
    </div>

    <div class="note">
      <b>المنتج:</b> ${tea.brand} — ${tea.teaType}<br/>
      <b>المذاق:</b> ${tasteLabel(taste)}<br/>
      <b>الماء:</b> ${waterMlInp.value} مل
    </div>
  `;
}

[teaSelect, waterMlInp, tasteSel].forEach(el => {
  el.addEventListener("input", render);
  el.addEventListener("change", render);
});

populateTeaSelect();
render();
</script>
</body>
</html>
